require=function a(r,s,c){function l(n,t){if(!s[n]){if(!r[n]){var e="function"==typeof require&&require;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var i=s[n]={exports:{}};r[n][0].call(i.exports,function(t){var e=r[n][1][t];return l(e||t)},i,i.exports,a,r,s,c)}return s[n].exports}for(var h="function"==typeof require&&require,t=0;t<c.length;t++)l(c[t]);return l}({1:[function(t,e,n){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function c(t){return"function"==typeof t}function l(t){return"object"==typeof t&&null!==t}function h(t){return void 0===t}((e.exports=o).EventEmitter=o).prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},o.prototype.emit=function(t){var e,n,o,i,a,r;if(this._events||(this._events={}),"error"===t&&(!this._events.error||l(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var s=new Error('Uncaught, unspecified "error" event. ('+e+")");throw s.context=e,s}if(h(n=this._events[t]))return!1;if(c(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:i=Array.prototype.slice.call(arguments,1),n.apply(this,i)}else if(l(n))for(i=Array.prototype.slice.call(arguments,1),o=(r=n.slice()).length,a=0;a<o;a++)r[a].apply(this,i);return!0},o.prototype.on=o.prototype.addListener=function(t,e){var n;if(!c(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,c(e.listener)?e.listener:e),this._events[t]?l(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,l(this._events[t])&&!this._events[t].warned&&(n=h(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},o.prototype.once=function(t,e){if(!c(e))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(t,o),n||(n=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},o.prototype.removeListener=function(t,e){var n,o,i,a;if(!c(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(i=(n=this._events[t]).length,o=-1,n===e||c(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(l(n)){for(a=i;0<a--;)if(n[a]===e||n[a].listener&&n[a].listener===e){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},o.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(c(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},o.prototype.listeners=function(t){return this._events&&this._events[t]?c(this._events[t])?[this._events[t]]:this._events[t].slice():[]},o.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(c(e))return 1;if(e)return e.length}return 0},o.listenerCount=function(t,e){return t.listenerCount(e)}},{}],BoxControl:[function(t,e,n){"use strict";cc._RF.push(e,"036fbzipCNF5IUG5jMtlbhj","BoxControl"),cc.Class({extends:cc.Component,properties:{ignoredColliderGroups:{default:[],type:[cc.String]}},onLoad:function(){this.isPointInArea=function(t,e,n){if(t&&e&&n){if(t.x<e.x-n.width/2||t.x>e.x+n.width/2)return!1;if(t.y<e.y-n.height/2||t.y>e.y+n.height/2)return!1}return!0}},start:function(){},onBeginContact:function(t,e,n){var o=!1,i=n.node.group,a=!0,r=!1,s=void 0;try{for(var c,l=this.ignoredColliderGroups[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){if(c.value===i){o=!0;break}}}catch(t){r=!0,s=t}finally{try{!a&&l.return&&l.return()}finally{if(r)throw s}}if(o){var h=!0;if(n.node.hasOwnProperty("collideSetting")){var u=n.node.collideSetting,d=u.once,p=u.originalGroup;if(u.hasOwnProperty("target")&&u.target!==this.node&&(h=!1,console.log("target error")),h&&u.hasOwnProperty("ignoreArea")&&u.hasOwnProperty("ignorePosition")){var f=t.getWorldManifold().points;if(f&&0<f.length){var g=!0,y=!0,m=!1,v=void 0;try{for(var b,C=f[Symbol.iterator]();!(y=(b=C.next()).done);y=!0){var x=b.value;if(!this.isPointInArea(this.node.convertToNodeSpaceAR(x),u.ignorePosition,u.ignoreArea)){g=!1;break}}}catch(t){m=!0,v=t}finally{try{!y&&C.return&&C.return()}finally{if(m)throw v}}g||(h=!1,console.log("area error"))}}d&&p&&(n.node.group=p,delete n.node.collideSetting)}t.disabled=h}}}),cc._RF.pop()},{}],BoxManager:[function(t,e,n){"use strict";cc._RF.push(e,"472damY6+BIPo61+5NAyNND","BoxManager"),cc.Class({extends:cc.Component,properties:{autoCreate:{default:!0},target:{default:null,type:cc.Node},boxPrefab:{default:null,type:cc.Prefab},connectNodePrefab:{default:null,type:cc.Prefab},starPrefab:{default:null,type:cc.Prefab},camera:{default:null,type:cc.Camera},onceCreatedCount:{default:2},minBoxSize:{default:cc.size(180,180)},maxBoxSize:{default:cc.size(220,220)},minBoxLeftX:{default:-150},maxBoxRigthX:{default:350},minBoxYInterval:{default:240},maxBoxYInterval:{default:260},createStarRatio:{default:.5},horizontalStarDist:{default:80},minStarX:{default:-385},maxStarX:{default:385}},onLoad:function(){var f=this;this.boxes=[],this.stars=[],this.connectNodes={},this.originalPosition=null,this.generateBox=function(){var t=void 0;if(f.highestReachedBox){var e=!0,n=!0,o=!1,i=void 0;try{for(var a,r=f.boxes[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){if(a.value.position.y-f.highestReachedBox.y>=f.minBoxYInterval-1){e=!1;break}}}catch(t){o=!0,i=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}if(!e)return;t=f.highestReachedBox.position.y+f.highestReachedBox.height/2}else{if(0<f.boxes.length)return;t=f.originalPosition.y-f.target.height/2}for(var s=0;s<f.onceCreatedCount;s++){var c=Math.random();c<.1?c=0:.9<c&&(c=1);var l=f.minBoxSize.width+Math.random()*(f.maxBoxSize.width-f.minBoxSize.width),h=f.minBoxSize.height+Math.random()*(f.maxBoxSize.height-f.minBoxSize.height),u=f.minBoxLeftX+l/2+c*(f.maxBoxRigthX-f.minBoxLeftX-l),d=t+f.minBoxYInterval+h/2+Math.random()*(f.maxBoxYInterval-f.minBoxYInterval),p=cc.instantiate(f.boxPrefab);f.node.addChild(p),p.width=l,p.height=h,p.getComponent(cc.PhysicsBoxCollider).size=new cc.Size(l,h),p.getComponent(cc.PhysicsBoxCollider).apply(),p.setPosition(new cc.Vec2(u,d)),f.camera.addTarget(p),f.boxes.push(p),f.createStars(p),t=d+h}return!0},this.createStars=function(t){var e=Math.random(),n=[Math.random(),Math.random(),Math.random()],o=[];if(e<1/3){var i=t.position.x-t.width/2-f.horizontalStarDist;if(i<=f.minStarX)return;n[0]<=f.createStarRatio&&o.push(new cc.Vec2(i,t.position.y-t.height/3)),n[1]<=f.createStarRatio&&o.push(new cc.Vec2(i,t.position.y)),n[2]<=f.createStarRatio&&o.push(new cc.Vec2(i,t.position.y+t.height/3))}else if(e<2/3){var a=t.position.x;n[0]<=f.createStarRatio&&o.push(new cc.Vec2(a,t.position.y+5*t.height/6)),n[1]<=f.createStarRatio&&o.push(new cc.Vec2(a,t.position.y+7*t.height/6)),n[2]<=f.createStarRatio&&o.push(new cc.Vec2(a,t.position.y+9*t.height/6))}else{var r=t.position.x+t.width/2+f.horizontalStarDist;if(r>=f.minStarX)return;n[0]<=f.createStarRatio&&o.push(new cc.Vec2(r,t.position.y-t.height/3)),n[1]<=f.createStarRatio&&o.push(new cc.Vec2(r,t.position.y)),n[2]<=f.createStarRatio&&o.push(new cc.Vec2(r,t.position.y+t.height/3))}var s=f;o.forEach(function(t){var e=cc.instantiate(s.starPrefab);s.node.addChild(e),e.getComponent("StarControl").players.push(f.target),e.setPosition(t),e.getComponent("StarControl").setCallback(function(t,e){s.starScore=s.starScore+1;var n=-1;for(var o in s.stars)if(s.stars[o].position.x==t.position.x&&s.stars[o].position.y==t.position.y){n=o;break}0<=n&&s.stars.splice(n,1)}),s.camera.addTarget(e),s.stars.push(e)})}},start:function(){this.score=0,this.starScore=0,this.highestReachedBox=null},lateUpdate:function(t){if(window.shared.gameStarted&&(this.originalPosition||(this.originalPosition=this.target.position),this.autoCreate&&this.generateBox(),this.target.getComponent("PlayerControl").isStill())){var e=0,n=null,o=!0,i=!1,a=void 0;try{for(var r,s=this.boxes[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var c=r.value;-1<=this.target.position.y-this.target.height/2-(c.position.y-c.height/2)&&(e+=1,(null==n||c.position.y>n.position.y)&&(n=c))}}catch(t){i=!0,a=t}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}this.setScore(e),this.setHighestReachedBox(n)}},setScore:function(t){this.score=t},setHighestReachedBox:function(t){this.highestReachedBox=t},setBoxesAlpha:function(e){this.boxes.forEach(function(t){t.opacity=e})},getScore:function(){return this.score+this.starScore},getHighestReachedBox:function(){return this.highestReachedBox},findNearestBox:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=null,o=null,i=!0,a=!1,r=void 0;try{for(var s,c=this.boxes[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;if(!(e&&-1<e.position.y-l.position.y)){var h=l.position.y+l.height/2,u=Math.abs(h-t);if((null==n||u<n)&&(o=l,0==(n=u)))break}}}catch(t){a=!0,r=t}finally{try{!i&&c.return&&c.return()}finally{if(a)throw r}}return{box:o,dist:n}},hasConnectedNode:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];return!!this.connectNodes.hasOwnProperty(t.position.y)&&this.connectNodes[t.position.y].hasOwnProperty(e?"left":"right")},createConnectedNode:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=cc.instantiate(this.connectNodePrefab);this.node.addChild(n);var o=void 0;o=e?t.position.x-t.width/2-n.width/2:t.position.x+t.width/2+n.width/2;var i=t.position.y+t.height/2-n.height/2;return n.setPosition(o,i),this.connectNodes.hasOwnProperty(t.position.y)||(this.connectNodes[t.position.y]={}),this.camera.addTarget(n),this.connectNodes[t.position.y][e?"left":"right"]=n},removeConnectedNode:function(t){var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this.connectNodes.hasOwnProperty(t.position.y)){var n=e?"left":"right",o=this.connectNodes[t.position.y][n];return o&&(this.camera.removeTarget(o),o.removeFromParent()),delete this.connectNodes[t.position.y][n],!0}return!1},destoryItems:function(){this.boxes.forEach(function(t){t.removeFromParent()}),this.stars.forEach(function(t){t.removeFromParent()}),this.boxes=[],this.stars=[],this.score=0,this.starScore=0,this.highestReachedBox=null}}),cc._RF.pop()},{}],BtnGroupClicks:[function(t,e,n){"use strict";cc._RF.push(e,"f8783oROvlEU4FvQVkPetC8","BtnGroupClicks"),cc.Class({extends:cc.Component,properties:{canvasNode:{default:null,type:cc.Node},btnGroup:{default:null,type:cc.Node}},onStartGameBtnClicked:function(){this.btnGroup.getComponent("BtnGroupControl").hideBtnGroup()},onLeaderBoardBtnClicked:function(){cc.director.loadScene("rank_scene")},onMultiPlayerBtnClicked:function(){this.canvasNode.getComponent("MultiPlayerHelper").showInviteDialog()}}),cc._RF.pop()},{}],BtnGroupControl:[function(t,e,n){"use strict";cc._RF.push(e,"1c4fffxViBNp44Qty/ez0/+","BtnGroupControl"),cc.Class({extends:cc.Component,properties:{btnGroup:{default:null,type:cc.Node},startGameBtn:{default:null,type:cc.Button},leaderBoardBtn:{default:null,type:cc.Button},shareBtn:{default:null,type:cc.Button},presentsBtn:{default:null,type:cc.Button},multiPlayerBtn:{default:null,type:cc.Button}},onLoad:function(){this.btnGroupHidden=!0,this.isAnimating=!1,this.showBtnGroup()},showBtnGroup:function(){if(this.btnGroupHidden&&!this.isAnimating){window.shared.gameStarted=!1,this.startGameBtn.interactable=!1,this.leaderBoardBtn.interactable=!1,this.shareBtn.interactable=!1,this.presentsBtn.interactable=!1,this.multiPlayerBtn.interactable=!1;var e=this;this.btnGroup.getComponent(cc.Animation).once("stop",function(t){"btn_group_show"==t.getUserData().clip.name&&(e.isAnimating=!1,e.btnGroupHidden=!1,e.startGameBtn.interactable=!0,e.leaderBoardBtn.interactable=!0,e.shareBtn.interactable=!0,e.presentsBtn.interactable=!0,e.multiPlayerBtn.interactable=!0)}),this.isAnimating=!0,this.btnGroup.getComponent(cc.Animation).play("btn_group_show")}},hideBtnGroup:function(){if(!this.btnGroupHidden&&!this.isAnimating){var e=this;this.btnGroup.getComponent(cc.Animation).once("stop",function(t){"btn_group_hide"==t.getUserData().clip.name&&(e.isAnimating=!1,e.btnGroupHidden=!0,window.shared.gameStarted=!0)}),this.startGameBtn.interactable=!1,this.leaderBoardBtn.interactable=!1,this.shareBtn.interactable=!1,this.presentsBtn.interactable=!1,this.multiPlayerBtn.interactable=!1,this.isAnimating=!0,this.btnGroup.getComponent(cc.Animation).play("btn_group_hide")}}}),cc._RF.pop()},{}],CameraControl:[function(t,e,n){"use strict";cc._RF.push(e,"c91b9356chLdpz8rTtL7ufe","CameraControl"),cc.Class({extends:cc.Component,properties:{focus:{default:null,type:cc.Node}},onLoad:function(){this.focusPosition=null},start:function(){},lateUpdate:function(t){if(window.shared.gameStarted){this.focusPosition||(this.focusPosition=this.focus.position);var e=this.focus.position,n=e.y-this.focusPosition.y;0!==n&&(this.node.position=new cc.Vec2(this.node.position.x,this.node.position.y+n)),this.focusPosition=e}}}),cc._RF.pop()},{}],CloseBtnControl:[function(t,e,n){"use strict";cc._RF.push(e,"8b5505IoHdL+JeKZoUbuE2f","CloseBtnControl"),cc.Class({extends:cc.Component,onCloseBtnClicked:function(){cc.director.loadScene("single_game")}}),cc._RF.pop()},{}],DialogBackgroundClick:[function(t,e,n){"use strict";cc._RF.push(e,"5d701LJRWBJM4cIwhDmm3YW","DialogBackgroundClick"),cc.Class({extends:cc.Component,properties:{dialog:{default:null,type:cc.Node}},onBackgroundClicked:function(){this.dialog.getComponent("DialogControl").dismiss()}}),cc._RF.pop()},{}],DialogControl:[function(t,e,n){"use strict";cc._RF.push(e,"a0d63caAwJOt7K57wGdfcqF","DialogControl"),cc.Class({extends:cc.Component,properties:{titleLabel:{default:null,type:cc.Label},dialogOuter:{default:null,type:cc.Node},dialogInner:{default:null,type:cc.Node},dialogBtnLayout:{default:null,type:cc.Node},title:{default:""},contentPrefabs:{default:[],type:[cc.Prefab]},btnPrefabs:{default:[],type:[cc.Prefab]},commonPrefabs:{default:[],type:[cc.Prefab]}},onLoad:function(){this.hidden=!0,this.isAnimating=!1,this.titleLabel.string=this.title,this.animation=this.dialogOuter.getComponent(cc.Animation);var n=this;this.commonPrefabs.forEach(function(t){var e=cc.instantiate(t);n.node.addChild(e)}),this.contentPrefabs.forEach(function(t){var e=cc.instantiate(t);n.dialogInner.addChild(e)}),this.btnPrefabs.forEach(function(t){var e=cc.instantiate(t);n.dialogBtnLayout.addChild(e)}),this.onShowListener=null,this.onDismissListener=null},setOnShowListener:function(t){this.onShowListener=t},setOnDismissListener:function(t){this.onDismissListener=t},show:function(){if(this.hidden&&!this.isAnimating){var e=this;this.animation.once("stop",function(t){"dialog_pop_out"==t.getUserData().clip.name&&(e.onShowListener&&e.onShowListener(e),e.isAnimating=!1,e.hidden=!1)}),this.isAnimating=!0,this.animation.play("dialog_pop_out")}},dismiss:function(){if(!this.hidden&&!this.isAnimating){var e=this;this.animation.once("stop",function(t){"dialog_dismiss"==t.getUserData().clip.name&&(e.onDismissListener&&e.onDismissListener(e),e.isAnimating=!1,e.hidden=!0,e.node.removeFromParent())}),this.isAnimating=!0,this.animation.play("dialog_dismiss")}}}),cc._RF.pop()},{}],Global:[function(t,e,n){"use strict";cc._RF.push(e,"833a4KAnVFD/LhNqSK5ecwj","Global");var o="jump_leader_global";function r(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,function(n){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return null==(e=window.shared.getFBInstant())?[2,null]:[4,e.getLeaderboardAsync(n)];case 1:return[2,t.sent()]}})})}(o)];case 1:return[2,t.sent()]}})})}function s(t){if(null==t)return null;var e={score:t.getScore(),rank:t.getRank(),player:{id:t.getPlayer().getID(),name:t.getPlayer().getName(),photo:t.getPlayer().getPhoto()}};return null!=t.getExtraData()&&(e.ext=t.getExtraData()),e}e.exports.getCurrentPlayer=function(){var t=window.shared.getFBInstant();return t?{id:t.player.getID(),name:t.player.getName(),photo:t.player.getPhoto()}:null},e.exports.getCurrentPlayerScore=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return null==(e=t.sent())?[3,3]:[4,e.getPlayerEntryAsync()];case 2:return[2,s(t.sent())];case 3:return[2,null]}})})},e.exports.getPlayerScoresCount=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:return(e=t.sent())?[4,e.getEntryCountAsync()]:[3,3];case 2:return[2,t.sent()];case 3:return[2,0]}})})},e.exports.getPlayerScores=function(i,a){return void 0===i&&(i=10),void 0===a&&(a=0),__awaiter(this,void 0,void 0,function(){var n,e,o;return __generator(this,function(t){switch(t.label){case 0:return n={},[4,r()];case 1:return null==(e=t.sent())?[3,3]:[4,e.getEntriesAsync(i,a)];case 2:null!=(o=t.sent())&&0<o.length&&o.forEach(function(t){var e=s(t);n[e.rank]=e}),t.label=3;case 3:return[2,n]}})})},e.exports.updateLeaderboard=function(o,i){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:return[4,r()];case 1:if(null==(e=t.sent()))return[3,5];t.label=2;case 2:return t.trys.push([2,4,,5]),[4,e.setScoreAsync(o,i)];case 3:return[2,s(t.sent())];case 4:return n=t.sent(),console.log(n),[3,5];case 5:return[2,null]}})})},e.exports.postLeaderboardUpdate=function(){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:if(null==(e=window.shared.getFBInstant()))return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.updateAsync({action:"LEADERBOARD",name:o})];case 2:return t.sent(),[2,!0];case 3:return n=t.sent(),console.log(n),[3,4];case 4:return[2,!1]}})})},e.exports.shareContent=function(o,i,a){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:if(null==(e=window.shared.getFBInstant()))return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.shareAsync({intent:"REQUEST",image:i,text:o,data:a})];case 2:return t.sent(),[2,!0];case 3:return n=t.sent(),console.log(n),[3,4];case 4:return[2,!1]}})})},e.exports.loadImage=function(a){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,(i=a,new Promise(function(e,n){try{var o=new XMLHttpRequest;o.open("GET",i,!0),o.responseType="blob",o.onload=function(t){e(o.response)},o.send()}catch(t){n(t)}}))];case 1:return(e=t.sent())?[4,(o=e,new Promise(function(n,e){try{var t=new FileReader;t.onload=function(t){var e=t.target.result;n(e)},t.readAsDataURL(o)}catch(t){e(t)}}))]:[3,3];case 2:return[2,t.sent()];case 3:return[3,5];case 4:return n=t.sent(),console.log(n),[3,5];case 5:return[2]}var o,i})})},cc._RF.pop()},{}],LoadingControl:[function(t,e,n){"use strict";cc._RF.push(e,"46ed3tgqjxHjIJBt+lR0zzS","LoadingControl");var o=t("SocketManager"),i=t("Global");cc.Class({extends:cc.Component,properties:{statusLabel:{default:null,type:cc.Label},playersLabel:{default:null,type:cc.Label}},onLoad:function(){this.roomId=null,this.statusLabel.string="Loading";var n=this;if(o.getInstance().getEvents().on("room_connected",function(){console.log("room connected"),n.enterRoom(n,"create")}),o.getInstance().getEvents().on("room_resp",function(t,e){console.log(e),"room.create"==t.type&&(e.hasOwnProperty("error")?(alert(JSON.stringify(e.error)),n.goBack()):(n.roomId=e.room.id,n.refreshRoomUI(n,e.room)))}),o.getInstance().getEvents().on("room_push",function(t){console.log(t),"players_property_changed"==t.event&&n.refreshRoomUI(n,t.room)}),console.log("socket state is "+o.getInstance().getState()),2===o.getInstance().getState()){if(!this.roomId)return void this.enterRoom(this,"create")}else 0===o.getInstance().getState()&&o.getInstance().connectRoom()},enterRoom:function(t,e){if("create"==e){var n=i.getCurrentPlayer();n&&o.getInstance().sendToRoomSocket("room.create",{creator:n})}},refreshRoomUI:function(t,e){var n=e.players,o="";Object.keys(n).forEach(function(t){o=o+n[t].name+"\n"}),t.playersLabel.string=o},gotoNextScene:function(){cc.director.loadScene("multi_player_game")},goBack:function(){cc.director.loadScene("welcome")},start:function(){}}),cc._RF.pop()},{Global:"Global",SocketManager:"SocketManager"}],MultiPlayerHelper:[function(t,e,n){"use strict";cc._RF.push(e,"656a6FsQDVCWJyL1c1ZyU3W","MultiPlayerHelper"),cc.Class({extends:cc.Component,properties:{dialogPrefab:{default:null,type:cc.Prefab},inviteContentPrefab:{default:null,type:cc.Prefab},inviteBtnPrefab:{default:null,type:cc.Prefab}},onLoad:function(){this.inviteDialog=null},showInviteDialog:function(){this.inviteDialog=cc.instantiate(this.dialogPrefab);var t=this.inviteDialog.getComponent("DialogControl");t.title="发起双人PK",t.contentPrefabs.push(this.inviteContentPrefab),t.btnPrefabs.push(this.inviteBtnPrefab);var e=this;t.setOnDismissListener(function(t){e.inviteDialog=null}),this.node.addChild(this.inviteDialog,100),t.show(this.node)}}),cc._RF.pop()},{}],MultiPlayerSendBtnControl:[function(t,e,n){"use strict";cc._RF.push(e,"e51d1CA2FlLVr+AOgftYdCn","MultiPlayerSendBtnControl");var o=t("Global"),i=t("SocketManager"),a=t("StateConstants").SOCKET;cc.Class({extends:cc.Component,properties:{button:{default:null,type:cc.Button}},onLoad:function(){var n=this;i.getInstance().getEvents().on("room_connected",function(){console.log("room connected"),n.enterRoom(n,"create")}),i.getInstance().getEvents().on("room_resp",function(t,e){console.log(e),"room.create"==t.type&&(e.hasOwnProperty("error")?alert(JSON.stringify(e.error)):(n.button.interactable=!0,i.getInstance().saveToRoomExtra("room_id",e.room.id)))}),i.getInstance().getEvents().on("room_push",function(t){console.log(t),"players_property_changed"==t.event&&n.refreshRoomUI(n,t.room)}),console.log("socket state is "+i.getInstance().getState());var t=i.getInstance().getRoomExtra("room_id");if(this.button.interactable=!!t,i.getInstance().getState()===a.ROOM_CONNECTED){if(!t)return void this.enterRoom(this,"create")}else i.getInstance().getState()===a.NOT_CONNECTED&&i.getInstance().connectRoom()},enterRoom:function(t,e){if("create"==e){var n=o.getCurrentPlayer();n&&i.getInstance().sendToRoomSocket("room.create",{creator:n})}},onSendBtnClicked:function(){var n=i.getInstance().getRoomExtra("room_id");n?o.loadImage("res/raw-assets/SingleGame/Textures/box.png").then(function(t){var e=o.getCurrentPlayer();o.shareContent(e.name+"邀请你参加一场战斗！",t,{type:"battle_request",data:{roomId:n}})}):alert("创建房间失败！")}}),cc._RF.pop()},{Global:"Global",SocketManager:"SocketManager",StateConstants:"StateConstants"}],PlayerControl:[function(t,e,n){"use strict";cc._RF.push(e,"8dc8aCRGlBAQJopcIaLBJYR","PlayerControl"),cc.Class({extends:cc.Component,properties:{impulseRatio:{default:20},maxImpluseX:{default:5e3},maxImpluseY:{default:5e3},maxLineLength:{default:200},dashGap:{default:15},minScaleRatio:{default:.5},playerIcon:{default:null,type:cc.Node},graphicsPannel:{default:null,type:cc.Graphics},tremblingVariance:{default:new cc.Vec2(.05,.05)},tremblingFrames:{default:10},grabDist:{default:new cc.size(20,20)},hangingColliderTolerence:{default:3}},onLoad:function(){var a=this;this.states={STATE_STILL:0,STATE_FALLING:1,STATE_FORCING_LOW:2,STATE_FORCING_HIGH:3,STATE_JUMPING:4,STATE_HANGING:5,STATE_HANGING_FORCING:6},this.events=new cc.EventTarget,this.body=this.getComponent(cc.RigidBody),this.playerDisplay=this.playerIcon.getComponent(dragonBones.ArmatureDisplay),this.boxManager=this.node.parent.getComponent("BoxManager"),this.setState(this.states.STATE_STILL),this.jumpStart=this.node.position,this.originalScaleY=this.node.scaleY,this.getActualVec=function(t){var e=t.mul(a.impulseRatio);return Math.abs(e.x)>Math.abs(a.maxImpluseX)&&(e=e.mul(Math.abs(a.maxImpluseX/e.x))),Math.abs(e.y)>Math.abs(a.maxImpluseY)&&(e=e.mul(Math.abs(a.maxImpluseY/e.y))),e},this.moveCursor=function(t,e,n){var o=n.mul(e/Math.sqrt(n.x*n.x+n.y*n.y)),i=new cc.Vec2(t.x+o.x,t.y+o.y);return a.graphicsPannel.moveTo(i.x,i.y),i},this.drawLine=function(t,e,n){a.graphicsPannel.moveTo(t.x,t.y);var o=n.mul(e/Math.sqrt(n.x*n.x+n.y*n.y)),i=new cc.Vec2(t.x+o.x,t.y+o.y);return a.graphicsPannel.lineTo(i.x,i.y),a.graphicsPannel.stroke(),i},this.setBoxesAlpha=function(t){a.boxManager.setBoxesAlpha(t)},this.findNearestBox=function(t,e){return a.boxManager.findNearestBox(t,e)},this.calcPositionVariance=function(t){var e=new cc.Vec2(0,0),n=!0,o=!1,i=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;e.addSelf(s)}}catch(t){o=!0,i=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}var c=e.div(t.length),l=new cc.Vec2(0,0),h=!0,u=!1,d=void 0;try{for(var p,f=t[Symbol.iterator]();!(h=(p=f.next()).done);h=!0){var g=p.value.sub(c);l.addSelf(new cc.Vec2(g.x*g.x,g.y*g.y))}}catch(t){u=!0,d=t}finally{try{!h&&f.return&&f.return()}finally{if(u)throw d}}return l.divSelf(t.length),l},this.gameFinishCallback=null},start:function(){this.positionList=[],this.connectedBox=null,this.connectedBoxLeft=!1,this.events.on("property_changed",function(t){var e=t.getUserData();if("state"==e.property)if(e.newValue==e.target.states.STATE_STILL)e.target.playerIcon.scaleX=Math.abs(e.target.playerIcon.scaleX),e.target.playerDisplay.playAnimation("idle",0);else if(e.newValue==e.target.states.STATE_FALLING)e.target.playerDisplay.playAnimation("luoxia",0);else if(e.newValue==e.target.states.STATE_FORCING_LOW)e.target.playerDisplay.playAnimation("xuli",1);else if(e.newValue==e.target.states.STATE_FORCING_HIGH)e.target.playerDisplay.playAnimation("xuli2",1);else if(e.newValue==e.target.states.STATE_JUMPING)0<e.extra.vec.x&&(e.target.playerIcon.scaleX=-Math.abs(e.target.playerIcon.scaleX)),e.target.playerDisplay.playAnimation("tiao",1);else if(e.newValue==e.target.states.STATE_HANGING){var n=e.target.boxManager.createConnectedNode(e.extra.box,e.extra.left),o=void 0;e.extra.left?(e.target.playerIcon.scaleX=-Math.abs(e.target.playerIcon.scaleX),(o=e.target.getComponents(cc.RevoluteJoint)[1]).connectedBody=n.getComponent(cc.RigidBody),o.connectedAnchor=new cc.Vec2(-n.width/2,n.height/2)):(e.target.playerIcon.scaleX=Math.abs(e.target.playerIcon.scaleX),(o=e.target.getComponents(cc.RevoluteJoint)[0]).connectedBody=n.getComponent(cc.RigidBody),o.connectedAnchor=new cc.Vec2(n.width/2,n.height/2)),o.apply(),e.target.connectedBox=e.extra.box,e.target.connectedBoxLeft=e.extra.left,e.target.playerDisplay.playAnimation("xuangua",1)}else e.newValue==e.target.states.STATE_HANGING_FORCING&&e.target.playerDisplay.playAnimation("xuangua2",1)})},setState:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(this.state!=t){var n=this.state;this.state=t,console.log("state changed from "+n+" to "+t),this.events.emit("property_changed",{target:this,property:"state",oldValue:n,newValue:this.state,extra:e})}},applyForce:function(t){if(this.isStill()){this.graphicsPannel.clear();for(var e=this.getActualVec(t).mul(this.maxLineLength/Math.sqrt(this.maxImpluseX*this.maxImpluseX+this.maxImpluseY*this.maxImpluseY)),n=Math.sqrt(e.x*e.x+e.y*e.y),o=Math.floor(n/this.dashGap),i=new cc.Vec2(this.graphicsPannel.node.width/2,this.graphicsPannel.node.height/2),a=0;a<o;a++)i=a%2==0?this.drawLine(i,this.dashGap,t):this.moveCursor(i,this.dashGap,t);if(o%2==0){var r=n-o*this.dashGap;0<r&&this.drawLine(i,r,t)}null!=this.connectedBox?this.setState(this.states.STATE_HANGING_FORCING,{vec:t}):n/this.maxLineLength<=.5?this.setState(this.states.STATE_FORCING_HIGH,{vec:t}):this.setState(this.states.STATE_FORCING_LOW,{vec:t})}},registerGameFinishCallback:function(t){this.gameFinishCallback=t},jump:function(t){if(this.graphicsPannel.clear(),this.isStill()){if(this.connectedBox){this.node.getComponents(cc.RevoluteJoint).forEach(function(t){t.connectedBody=null,t.connectedAnchor=new cc.Vec2(0,0),t.apply()}),this.boxManager.removeConnectedNode(this.connectedBox,this.connectedBoxLeft);var e=void 0;e=this.connectedBoxLeft?-this.connectedBox.width/2:this.connectedBox.width/2,this.node.collideSetting={target:this.connectedBox,ignoreArea:new cc.size(this.hangingColliderTolerence,this.connectedBox.height+this.hangingColliderTolerence),ignorePosition:new cc.Vec2(e,0),once:!0,originalGroup:this.node.group},this.node.group="hanging",this.connectedBox=null,this.connectedBoxLeft=!1}this.jumpStart=this.node.position,this.body.applyLinearImpulse(this.getActualVec(t),this.body.getWorldCenter(),!0),this.setState(this.states.STATE_JUMPING,{vec:t})}},lateUpdate:function(t){window.shared.gameStarted&&(this.originalPosition||(this.originalPosition=this.node.position));var e=this.node.position;if(this.positionList.length>this.tremblingFrames&&this.positionList.shift(),this.positionList.push(e),this.state==this.states.STATE_JUMPING){var n=this.findNearestBox(this.node.position.y,this.boxManager.getHighestReachedBox()),o=n.box,i=n.dist;if(o&&Math.abs(i)<=this.grabDist.height){if(Math.abs(e.x+this.node.width/2-o.position.x+o.width/2)<=this.grabDist.width)return void(this.boxManager.hasConnectedNode(o,!0)||this.setState(this.states.STATE_HANGING,{box:o,left:!0}));if(Math.abs(e.x-this.node.width/2-o.position.x-o.width/2)<=this.grabDist.width)return void(this.boxManager.hasConnectedNode(o,!1)||this.setState(this.states.STATE_HANGING,{box:o,left:!1}))}}var a=this.calcPositionVariance(this.positionList);a.x<this.tremblingVariance.x&&a.y<this.tremblingVariance.y?this.isForcing()||this.state==this.states.STATE_HANGING||this.setState(this.states.STATE_STILL):this.isFalling()?this.originalPosition&&e.y-this.originalPosition.y<=1&&(this.jumpStart=this.originalPosition,this.setState(this.states.STATE_STILL),this.node.group="default",this.setBoxesAlpha(255),null!==this.gameFinishCallback&&this.gameFinishCallback()):e.y-this.jumpStart.y+this.node.height<0&&(this.setState(this.states.STATE_FALLING),this.node.group="falling",this.setBoxesAlpha(100))},getEvents:function(){return this.events},isStill:function(){return this.state==this.states.STATE_STILL||this.state==this.states.STATE_HANGING||this.isForcing()},isFalling:function(){return this.state==this.states.STATE_FALLING},isForcing:function(){return this.state==this.states.STATE_FORCING_LOW||this.state==this.states.STATE_FORCING_HIGH||this.state==this.states.STATE_HANGING_FORCING}}),cc._RF.pop()},{}],RankItemControl:[function(t,e,n){"use strict";cc._RF.push(e,"f347cofYLZIHJXr1rK+leMv","RankItemControl"),cc.Class({extends:cc.Component,properties:{rankView:{default:null,type:cc.Sprite},rankLabel:{default:null,type:cc.Label},rankPlayerThumb:{default:null,type:cc.Sprite},rankPlayerName:{default:null,type:cc.Label},rankPlayerScore:{default:null,type:cc.Label},rankSprites:{default:[],type:[cc.SpriteFrame]}},initData:function(t){if(t&&(t.rank&&t.rank<=this.rankSprites.length?(this.rankView.enabled=!0,this.rankView.spriteFrame=this.rankSprites[t.rank-1],this.rankLabel.enabled=!1):(this.rankLabel.enabled=!0,this.rankLabel.string=t.rank,this.rankView.enabled=!1),t.score&&(this.rankPlayerScore.string=t.score),t.player&&(t.player.name&&(this.rankPlayerName.string=t.player.name),t.player.photo))){var n=this;cc.loader.load(t.player.photo,function(t,e){t?console.log(t):e&&(n.rankPlayerThumb.spriteFrame=new cc.SpriteFrame(e))})}}}),cc._RF.pop()},{}],RankManager:[function(t,e,n){"use strict";cc._RF.push(e,"fa46aO0ZC5Hxr6mSApj8T3/","RankManager");var i=t("Global");cc.Class({extends:cc.Component,properties:{rankScrollView:{default:null,type:cc.Node},rankContent:{default:null,type:cc.Node},rankItemPrefab:{default:null,type:cc.Prefab},rankSelfView:{default:null,type:cc.Node}},onLoad:function(){var e=this;this.totalCount=0,this.scoreItems={},i.getCurrentPlayerScore().then(function(t){e.rankSelfView.getComponent("RankItemControl").initData(t)}).catch(function(t){t&&alert(JSON.stringify(t))}),i.getPlayerScoresCount().then(function(t){0<t&&(e.totalCount=t,e.loadNewData(e))}).catch(function(t){t&&alert(JSON.stringify(t))}),this.rankScrollView.on("bounce-bottom",function(){e.loadNewData(e)})},loadNewData:function(o){var t=Object.keys(o.scoreItems).length,e=o.totalCount-t;if(e<=0)return!1;var n=e<10?e:10;return i.getPlayerScores(n,t).then(function(n){if(n){var t=Object.keys(n);0<t.length&&(t.sort(function(t,e){var n="string"==typeof t?parseInt(t):t,o="string"==typeof e?parseInt(e):e;return o<n?1:n<o?-1:0}).forEach(function(t){var e=cc.instantiate(o.rankItemPrefab);o.rankContent.addChild(e),e.getComponent("RankItemControl").initData(n[t])}),Object.assign(o.scoreItems,n))}}).catch(function(t){alert(JSON.stringify(t))}),!0}}),cc._RF.pop()},{Global:"Global"}],ResultBtnsControl:[function(t,e,n){"use strict";cc._RF.push(e,"491ceAHyHFPqqhU53UXxwzg","ResultBtnsControl"),cc.Class({extends:cc.Component,onRestartBtnClicked:function(){this.node.parent.getComponent("ResultPannelControl").closeSelf({intent:"restart"})}}),cc._RF.pop()},{}],ResultPannelControl:[function(t,e,n){"use strict";cc._RF.push(e,"e8b56wGEHZCkrwS5skAp3Ar","ResultPannelControl"),cc.Class({extends:cc.Component,properties:{successPrefab:{default:null,type:cc.Prefab},failPrefab:{default:null,type:cc.Prefab},backgroundPannel:{default:null,type:cc.Node},scoreLabel:{default:null,type:cc.Label},historyLabel:{default:null,type:cc.Label}},onLoad:function(){this.backgroundPannel.zIndex=-100},initData:function(t,e){if(this.caller=t,e){e.score&&(this.scoreLabel.string=e.score),e.historyScore&&(this.historyLabel.string=e.historyScore);var n=void 0;n=e.score>e.historyScore?cc.instantiate(this.successPrefab):cc.instantiate(this.failPrefab),this.node.addChild(n,-1)}},closeSelf:function(t){this.caller&&this.caller.hideResultPannel(this.caller,t)}}),cc._RF.pop()},{}],SingleGameControl:[function(t,e,n){"use strict";cc._RF.push(e,"d1d6dJ/f9FB2owvsXrWHMB/","SingleGameControl");var a=t("Global");cc.Class({extends:cc.Component,properties:{gravity:{default:-320},playerControl:{default:null,type:cc.Node},castalNode:{default:null,type:cc.Node},camera:{default:null,type:cc.Camera},scoreLabel:{default:null,type:cc.Label},leftWallPrefab:{default:null,type:cc.Prefab},rightWallPrefab:{default:null,type:cc.Prefab},backgroundPrefab:{default:null,type:cc.Prefab},leftWallInitPosition:{default:new cc.Vec2(-289,807)},rightWallInitPosition:{default:new cc.Vec2(289,807)},backgroundInitPosition:{default:new cc.Vec2(0,1447)},backgroundZIndex:{default:-3},wallZIndex:{default:-1},castalNodeZIndex:{default:-2},resultPannelPrefab:{default:null,type:cc.Prefab},historyBestLabel:{default:null,type:cc.Label},btnGroup:{default:null,type:cc.Node}},onLoad:function(){var n=this;this.scoreLabel.node.zIndex=1,cc.director.getPhysicsManager().gravity=new cc.Vec2(0,this.gravity),this.boxManager=this.getComponent("BoxManager"),this.resultPannel=null,this.hideResultPannel(this);var o=null,i=null;this.castalNode.zIndex=this.castalNodeZIndex,this.node.on(cc.Node.EventType.TOUCH_START,function(t){window.shared.gameStarted&&(o=t.touch.getLocation(),i=o)}),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(window.shared.gameStarted){var e=t.touch.getLocation();null!==o&&n.playerControl.getComponent("PlayerControl").applyForce(new cc.Vec2(o.x-e.x,o.y-e.y)),i=e}}),this.node.on(cc.Node.EventType.TOUCH_END,function(t){if(window.shared.gameStarted&&null!==o){var e=t.touch.getLocation();n.playerControl.getComponent("PlayerControl").jump(new cc.Vec2(o.x-e.x,o.y-e.y)),i=o=null}}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){window.shared.gameStarted&&null!==o&&null!=i&&(n.playerControl.getComponent("PlayerControl").jump(new cc.Vec2(o.x-i.x,o.y-i.y)),i=o=null)}),this.leftWalls=[],this.rightWalls=[],this.backgrounds=[],this.getTopMostNode=function(t){var e=null,n=!0,o=!1,i=void 0;try{for(var a,r=t[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value;null===e?e=s:e.y<s.y&&(e=s)}}catch(t){o=!0,i=t}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}return e};var e=this;a.getCurrentPlayerScore().then(function(t){t&&t.score&&e.refreshHistoryScore(e,t.score)}).catch(function(t){t&&alert(JSON.stringify(t))}),this.refreshHistoryScore(this,0)},refreshHistoryScore:function(t,e){t.historyBestScore=e,t.historyBestLabel.string=t.historyBestScore},hideResultPannel:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;t.resultPannel&&(t.resultPannel.removeFromParent(),t.resultPannel=null,e&&e.intent&&"restart"==e.intent&&t.btnGroup.getComponent("BtnGroupControl").showBtnGroup())},showResultPannel:function(t,e){t.resultPannel||(t.resultPannel=cc.instantiate(t.resultPannelPrefab),t.node.addChild(t.resultPannel,100),t.resultPannel.getComponent("ResultPannelControl").initData(t,e))},start:function(){var t=cc.instantiate(this.leftWallPrefab);this.node.addChild(t,this.wallZIndex),t.setPosition(this.leftWallInitPosition),this.camera.addTarget(t),this.leftWalls.push(t);var e=cc.instantiate(this.rightWallPrefab);this.node.addChild(e,this.wallZIndex),e.setPosition(this.rightWallInitPosition),this.camera.addTarget(e),this.rightWalls.push(e);var n=cc.instantiate(this.backgroundPrefab);this.node.addChild(n,this.backgroundZIndex),n.setPosition(this.backgroundInitPosition),this.camera.addTarget(n),this.backgrounds.push(n);var o=this;this.playerControl.getComponent("PlayerControl").registerGameFinishCallback(function(){if(window.shared.gameStarted){var t=o.boxManager.getScore(),e=o.historyBestScore;o.boxManager.destoryItems(),window.shared.gameStarted=!1,setTimeout(function(){o.showResultPannel(o,{score:t,historyScore:e})},200),t>o.historyBestScore&&a.updateLeaderboard(t,"").then(function(t){t?console.log("score update succeed"):console.log("score update failed")}).catch(function(t){t&&alert(JSON.stringify(t))})}})},lateUpdate:function(t){if(window.shared.gameStarted){var e=this.getTopMostNode(this.leftWalls),n=this.getTopMostNode(this.rightWalls),o=this.getTopMostNode(this.backgrounds),i=this.camera.node.parent.position;if(null!==e&&i.y>e.position.y){var a=cc.instantiate(this.leftWallPrefab);this.node.addChild(a,this.wallZIndex),a.setPosition(new cc.Vec2(e.position.x,e.position.y+e.height)),this.camera.addTarget(a),this.leftWalls.push(a)}if(null!==n&&i.y>n.position.y){var r=cc.instantiate(this.rightWallPrefab);this.node.addChild(r,this.wallZIndex),r.setPosition(new cc.Vec2(n.position.x,n.position.y+n.height)),this.camera.addTarget(r),this.rightWalls.push(r)}if(null!==o&&i.y>o.position.y){var s=cc.instantiate(this.backgroundPrefab);this.node.addChild(s,this.backgroundZIndex),s.setPosition(new cc.Vec2(o.position.x,o.position.y+o.height)),this.camera.addTarget(s),this.backgrounds.push(s)}var c=this.boxManager.getScore();this.scoreLabel.string=c}}}),cc._RF.pop()},{Global:"Global"}],SocketManager:[function(t,e,n){"use strict";cc._RF.push(e,"5b5c1TRuA9MU7BLUiydIqDJ","SocketManager");var o,i=t("events").EventEmitter,a=t("StateConstants").SOCKET;function r(){this.state=a.NOT_CONNECTED,this.events=new i,this.roomSocket=null,this.roomExtra={},this.roomSocketTrial=0,WebSocket.prototype.sendObj=function(t){if(t)try{this.send(JSON.stringify(t))}catch(t){console.log(t)}}}r.prototype.getEvents=function(){return this.events},r.prototype.setState=function(t){var e=this.state;this.state=t,this.events.emit("property_changed",this,"state",e,t)},r.prototype.getState=function(){return this.state},r.prototype.connectRoom=function(){if(console.log("connecting on state "+this.getState()),this.state===a.NOT_CONNECTED){this.setState(a.CONNECTING_ROOM),this.roomSocket&&this.roomSocket.close();var t=window.shared.getOptions();this.roomSocket=new WebSocket(t.roomHost);var n=this;return this.roomSocket.onopen=function(t){console.log("onpen"),n.roomExtra={},n.setState(a.ROOM_CONNECTED),n.events.emit("room_connected")},this.roomSocket.onmessage=function(t){if(console.log("onmessage"),t&&t.data){var e=null;try{e=JSON.parse(t.data)}catch(t){console.log(t)}e&&e.hasOwnProperty("type")&&(0===e.type?n.events.emit("room_resp",e.req,e.result):1==e.type&&n.events.emit("room_push",e.data))}},this.roomSocket.onerror=function(t){console.log("onerror"),console.log(t),xx,n.setState(a.NOT_CONNECTED),n.roomSocketTrial<=3?(n.roomSocketTrial++,n.connectRoom()):(n.roomSocketTrial=0,n.events.emit("room_connect_error"))},this.roomSocket.onclose=function(t){console.log("onclose"),n.setState(a.NOT_CONNECTED),n.events.emit("room_connect_close")},!0}return!1},r.prototype.sendToRoomSocket=function(t,e){return this.state===a.ROOM_CONNECTED&&(this.roomSocket.sendObj({type:t,data:e}),!0)},r.prototype.saveToRoomExtra=function(t,e){t&&e&&(this.roomExtra[t]=e)},r.prototype.getRoomExtra=function(t){if(t)return this.roomExtra[t]},e.exports={getInstance:function(){return o||(o=new r),o}},cc._RF.pop()},{StateConstants:"StateConstants",events:1}],StarControl:[function(t,e,n){"use strict";cc._RF.push(e,"aa1940yIHFAHqjF8PO3cqAS","StarControl"),cc.Class({extends:cc.Component,properties:{players:{default:[],type:[cc.Node]},dismissDist:{default:new cc.Vec2(70,70)}},onLoad:function(){this.callback=null},setCallback:function(t){this.callback=t},start:function(){var r=this;this.isDismissing=!1,this.findContactedPlayer=function(){var t=!0,e=!1,n=void 0;try{for(var o,i=r.players[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var a=o.value;if(Math.abs(a.position.x-r.node.position.x)<=r.dismissDist.x&&Math.abs(a.position.y-r.node.position.y)<=r.dismissDist.y)return a}}catch(t){e=!0,n=t}finally{try{!t&&i.return&&i.return()}finally{if(e)throw n}}return null}},lateUpdate:function(t){var e=this.findContactedPlayer();if(e&&!this.isDismissing){this.isDismissing=!0,this.callback&&this.callback(this.node,e);var n=this;n.players=[],this.getComponent(cc.Animation).on("stop",function(){n.node.removeFromParent()}),this.getComponent(cc.Animation).play("star_dismiss")}}}),cc._RF.pop()},{}],StateConstants:[function(t,e,n){"use strict";cc._RF.push(e,"178aaQVSJJJz4dj16x5gBky","StateConstants"),e.exports={SOCKET:{NOT_CONNECTED:0,CONNECTING_ROOM:1,ROOM_CONNECTED:2,CONNECTING_BATTLE:3,BATTLE_CONNECTED:4}},cc._RF.pop()},{}]},{},["Global","BoxControl","BoxManager","BtnGroupClicks","BtnGroupControl","CameraControl","CloseBtnControl","DialogBackgroundClick","DialogControl","LoadingControl","MultiPlayerHelper","MultiPlayerSendBtnControl","PlayerControl","RankItemControl","RankManager","ResultBtnsControl","ResultPannelControl","SingleGameControl","StarControl","SocketManager","StateConstants"]);